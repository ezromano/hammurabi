# Namespace:    Hammurabi.Sandbox
# Summary:      A host of random unit tests
# Updated:      2012-07-25
# Author:       Michael Poulshock


# INFINITE LOOPS

# Recursive rule that looks for unknown people
TboolIn IsCitizen(Person p) =
	# >> Is {1} a citizen by law?
	TboolIn IsCitizenByLaw(p) |
	IsCitizen(mom)
		
	Person mom =
		PersonIn MotherOf(p)
		
# >>What's the name of {1}'s mother?
# PersonIn MotherOf(Person p)

	
Test: Loop1
- Person p
- Sandbox.IsCitizen(p).Out =?= "Unstated"

Test: Loop2
- Person p
- Person mom
- MotherOf(p) = mom
- Sandbox.IsCitizen(p).Out =?= "Unstated"

Test: Loop3
- Person p
- Person mom
- MotherOf(p) = mom
- IsCitizenByLaw(p) = false
- IsCitizenByLaw(mom) = true
- Sandbox.IsCitizen(p).Out =?= true

Test: Loop4
- Person p
- IsCitizenByLaw(p) = true
- Sandbox.IsCitizen(p).Out =?= true

Test: Loop5
- Person p
- IsCitizenByLaw(p) = false
- Sandbox.IsCitizen(p).Out =?= "Unstated"

Test: Loop6
- Person p
- Person mom
- MotherOf(p) = mom
- IsCitizenByLaw(p) = false
- IsCitizen(mom) = false
- Sandbox.IsCitizen(p).Out =?= false


# METHODS WITH THREE PARAMETERS

Tbool Another3ParamTest(Person a, Person b, Person c) =
	TboolIn ABC(a,b,c)

TboolIn IsABC(Person a, Person b, Property c) =
	Stub() |
	IsXYZ(a,b,c)

TboolIn IsXYZ(Person x, Person y, Property z)

Test: Param3_1a
- Person x
- Person y
- Property z
- IsXYZ(x,y,z) = true
- Sandbox.IsXYZ(x,y,z).Out =?= true

Test: Param3_1b
- Person x
- Person y
- Property z
- IsXYZ(x,y,z) = false
- Sandbox.IsXYZ(x,y,z).Out =?= false

Test: Param3_1c
- Person x
- Person y
- Property z
- Sandbox.IsXYZ(x,y,z).Out =?= "Unstated"

Test: Param3_2a
- Person a
- Person b
- Person c
- ABC(a,b,c) = true
- Sandbox.Another3ParamTest(a,b,c).Out =?= true

Test: Param3_2b
- Person a
- Person b
- Person c
- ABC(a,b,c) = false
- Sandbox.Another3ParamTest(a,b,c).Out =?= false

Test: Param3_2c
- Person a
- Person b
- Person c
- Sandbox.Another3ParamTest(a,b,c).Out =?= "Unstated"


# TIME-VARYING BOOLEANS
	
# Time-varying boolean subrule
Tbool SomeTemporalBooleanSubrule() =
	rule
	
	Tbool rule =
		temporal:
		from Time.DawnOf -> false
		from 2000-01-01 -> true
		from 2001-01-01 -> false
		endtemporal
	
Test: TimeVaryingBooleanSub1
- Sandbox.SomeTemporalBooleanSubrule().AsOf(1999-03-09).Out =?= false

Test: TimeVaryingBooleanSub2
- Sandbox.SomeTemporalBooleanSubrule().AsOf(2000-03-09).Out =?= true

Test: TimeVaryingBooleanSub3
- Sandbox.SomeTemporalBooleanSubrule().AsOf(2002-03-09).Out =?= false		
	
	
# Time-varying boolean
Tbool SomeTemporalBoolean() =
	temporal:
	from Time.DawnOf -> false
	from 2000-01-01 -> true
	from 2001-01-01 -> false
	endtemporal
		
Test: TimeVaryingBoolean1
- Sandbox.SomeTemporalBoolean().AsOf(1999-03-09).Out =?= false

Test: TimeVaryingBoolean2
- Sandbox.SomeTemporalBoolean().AsOf(2000-03-09).Out =?= true

Test: TimeVaryingBoolean3
- Sandbox.SomeTemporalBoolean().AsOf(2002-03-09).Out =?= false		
		